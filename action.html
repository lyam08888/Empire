<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Empire - Prototype de Jeu Complet</title>
    <meta name="description" content="Prototype d'interface complet pour le jeu de strat√©gie Empire, bas√© sur un cahier des charges d√©taill√©.">
    <meta name="author" content="Empire Game Studio">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' fill='%231e3a8a'/><text x='16' y='20' text-anchor='middle' fill='white' font-family='Arial' font-size='18' font-weight='bold'>E</text></svg>" type="image/svg+xml">

    <style>
        :root {
            --color-primary: #fbbf24; /* Or */
            --color-secondary: #3b82f6; /* Bleu */
            --color-dark-1: #0a192f; /* Fond principal */
            --color-dark-2: #1e3a8a; /* D√©grad√© fond */
            --color-panel: rgba(15, 23, 42, 0.8); /* Panneaux */
            --color-panel-light: rgba(30, 41, 59, 0.8);
            --color-text: #e2e8f0;
            --color-text-muted: #94a3b8;
            --color-border: rgba(148, 163, 184, 0.2);
        }

        /* Styles de base et reset */
        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, var(--color-dark-1), var(--color-dark-2));
            color: var(--color-text);
            height: 100vh;
            overflow: hidden;
        }
        .hidden { display: none !important; }

        /* --- LAYOUT GLOBAL --- */
        .game-ui { display: flex; flex-direction: column; height: 100%; }
        .game-header, .game-footer { flex-shrink: 0; z-index: 100; }
        .game-body { display: flex; flex-grow: 1; overflow: hidden; padding: 1rem; gap: 1rem; }

        /* --- HEADER --- */
        .game-header { padding: 0.5rem 1rem; background: var(--color-panel); backdrop-filter: blur(5px); border-bottom: 1px solid var(--color-border); }
        .header-content { display: flex; justify-content: space-between; align-items: center; max-width: 1600px; margin: 0 auto; }
        .resources { display: flex; flex-wrap: wrap; gap: 1rem; background: var(--color-panel-light); padding: 0.5rem 1rem; border-radius: 0.5rem; }
        .resource-item { display: flex; align-items: center; gap: 0.5rem; font-weight: bold; }
        .resource-item span { color: var(--color-primary); }
        .player-info a { color: var(--color-text-muted); text-decoration: none; transition: color 0.3s; }
        .player-info a:hover { color: var(--color-primary); }

        /* --- BARRE DE NAVIGATION GAUCHE --- */
        .left-sidebar { width: 200px; flex-shrink: 0; background: var(--color-panel); padding: 1rem; border-radius: 1rem; overflow-y: auto; }
        .main-nav ul { list-style: none; }
        .main-nav li a { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; margin-bottom: 0.5rem; color: var(--color-text); text-decoration: none; border-radius: 0.5rem; transition: all 0.3s; cursor: pointer; }
        .main-nav li a:hover, .main-nav li a.active { background: rgba(251, 191, 36, 0.1); color: var(--color-primary); transform: translateX(5px); }

        /* --- VUE CENTRALE (Conteneur) --- */
        .main-view-container { flex-grow: 1; position: relative; }
        .main-view {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://www.transparenttextures.com/patterns/dark-matter.png'), linear-gradient(135deg, #1c2a4b, #111827);
            border-radius: 1rem;
            overflow: auto;
            padding: 1.5rem;
        }
        
        /* --- VUE VILLE --- */
        .city-view-content { position: relative; width: 100%; height: 100%; }
        .building-plot {
            position: absolute; background: rgba(30, 64, 175, 0.3); border: 2px dashed rgba(59, 130, 246, 0.5);
            border-radius: 0.5rem; cursor: pointer; transition: all 0.3s; display: flex; justify-content: center;
            align-items: center; font-size: 2rem; color: rgba(255, 255, 255, 0.5);
        }
        .building-plot:hover, .building-plot.selected { background: rgba(251, 191, 36, 0.3); border-color: var(--color-primary); }
        .building-plot.constructing::after { content: '‚è≥'; position: absolute; top: 5px; right: 5px; font-size: 1rem; }
        .building-plot .level { position: absolute; bottom: 2px; right: 5px; font-size: 0.8rem; font-weight: bold; color: white; background: rgba(0,0,0,0.5); padding: 0 4px; border-radius: 3px; }

        /* --- VUE √éLE & MONDE --- */
        .map-grid { display: grid; gap: 1rem; }
        .island-view-content { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); }
        .world-view-content { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
        .map-tile { background: var(--color-panel-light); border: 1px solid var(--color-border); border-radius: 0.5rem; padding: 1rem; text-align: center; cursor: pointer; transition: all 0.3s; }
        .map-tile:hover { border-color: var(--color-primary); transform: translateY(-5px); }
        .map-tile h4 { color: var(--color-primary); }
        .map-tile p { color: var(--color-text-muted); font-size: 0.9rem; }

        /* --- PANNEAU CONTEXTUEL DROIT --- */
        .right-sidebar { width: 280px; flex-shrink: 0; background: var(--color-panel); padding: 1rem; border-radius: 1rem; display: flex; flex-direction: column; }
        .context-panel h3 { color: var(--color-primary); border-bottom: 1px solid var(--color-border); padding-bottom: 0.5rem; margin-bottom: 1rem; }
        #context-content p { color: var(--color-text-muted); line-height: 1.5; }
        #context-content .action-btn { width: 100%; background: var(--color-primary); color: var(--color-dark-1); border: none; padding: 0.75rem; border-radius: 0.5rem; font-weight: bold; font-size: 1rem; cursor: pointer; margin-top: 1rem; transition: transform 0.2s; }
        #context-content .action-btn:hover { transform: scale(1.05); }
        .build-queue-list { list-style: none; margin-top: auto; padding-top: 1rem; }
        .queue-item { background: var(--color-panel-light); padding: 0.75rem; border-radius: 0.5rem; margin-bottom: 0.5rem; }
        .queue-item .name { font-weight: bold; }
        .queue-item .timer { color: var(--color-primary); }

        /* --- FOOTER --- */
        .game-footer { padding: 0.5rem 1rem; background: var(--color-panel); border-top: 1px solid var(--color-border); }
        .footer-content { max-width: 1600px; margin: 0 auto; color: var(--color-text-muted); text-align: center; }

        /* --- MODAL --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: var(--color-dark-1); border: 1px solid var(--color-primary); padding: 2rem; border-radius: 1rem; text-align: center; width: 90%; max-width: 400px; }
        .modal-content h4 { font-size: 1.5rem; color: var(--color-primary); margin-bottom: 1rem; }
        #modal-cost { color: var(--color-text-muted); margin-bottom: 1rem; }
        .modal-actions { display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem; }
        .modal-btn { border: none; padding: 0.75rem 1.5rem; border-radius: 0.5rem; cursor: pointer; font-weight: bold; transition: opacity 0.3s; }
        .modal-btn.confirm { background: var(--color-primary); color: var(--color-dark-1); }
        .modal-btn.cancel { background: var(--color-panel-light); color: var(--color-text); }
        .modal-btn:hover { opacity: 0.8; }
    </style>
</head>
<body>
    <div class="game-ui">
        <!-- HEADER -->
        <header class="game-header">
            <div class="header-content">
                <div class="player-info"><a href="#">Joueur_01</a></div>
                <div class="resources">
                    <div class="resource-item" title="Bois">üå≤ <span id="resWood">0</span></div>
                    <div class="resource-item" title="Vin">üçá <span id="resWine">0</span></div>
                    <div class="resource-item" title="Marbre">üèõÔ∏è <span id="resMarble">0</span></div>
                    <div class="resource-item" title="Cristal">üíé <span id="resCrystal">0</span></div>
                    <div class="resource-item" title="Soufre">üî• <span id="resSulfur">0</span></div>
                    <div class="resource-item" title="Or">üí∞ <span id="resGold">0</span></div>
                </div>
                <div class="player-info"><a href="#">D√©connexion</a></div>
            </div>
        </header>

        <!-- CORPS PRINCIPAL -->
        <main class="game-body">
            <!-- MENU GAUCHE -->
            <nav class="left-sidebar">
                <div class="main-nav">
                    <ul>
                        <li><a data-view="city">üèõÔ∏è <span>Ville</span></a></li>
                        <li><a data-view="island">üèùÔ∏è <span>√éle</span></a></li>
                        <li><a data-view="world">üåç <span>Monde</span></a></li>
                        <li><a data-view="research">üî¨ <span>Recherche</span></a></li>
                        <li><a data-view="military">‚öîÔ∏è <span>Militaire</span></a></li>
                        <li><a data-view="diplomacy">ü§ù <span>Diplomatie</span></a></li>
                    </ul>
                </div>
            </nav>

            <!-- VUE CENTRALE (Conteneur pour toutes les vues) -->
            <div class="main-view-container">
                <section id="view-city" class="main-view">
                    <div class="city-view-content" id="city-grid"></div>
                </section>
                <section id="view-island" class="main-view hidden">
                    <h2>Vue de l'√éle</h2>
                    <div class="map-grid island-view-content">
                        <div class="map-tile"><h4>Scierie (Commun)</h4><p>Niveau 5</p></div>
                        <div class="map-tile"><h4>Mine de Marbre</h4><p>Niveau 3</p></div>
                        <div class="map-tile"><h4>Ville de Joueur_02</h4><p>Points: 1,250</p></div>
                        <div class="map-tile"><h4>Votre Ville</h4><p>Points: 800</p></div>
                    </div>
                </section>
                <section id="view-world" class="main-view hidden">
                    <h2>Carte du Monde</h2>
                     <div class="map-grid world-view-content">
                        <!-- Grille g√©n√©r√©e par JS -->
                     </div>
                </section>
                <section id="view-research" class="main-view hidden"><h2>Recherche</h2><p>Interface de recherche √† venir...</p></section>
                <section id="view-military" class="main-view hidden"><h2>Militaire</h2><p>Interface militaire √† venir...</p></section>
                <section id="view-diplomacy" class="main-view hidden"><h2>Diplomatie</h2><p>Interface de diplomatie √† venir...</p></section>
            </div>
            
            <!-- PANNEAU DROIT -->
            <aside class="right-sidebar">
                <div id="context-panel">
                    <h3>Informations</h3>
                    <div id="context-content"><p>S√©lectionnez un √©l√©ment pour voir ses d√©tails.</p></div>
                </div>
                <div class="build-queue-list" id="buildQueueListWrapper">
                     <h3>File de construction</h3>
                     <ul id="buildQueueList"></ul>
                </div>
            </aside>
        </main>

        <!-- FOOTER -->
        <footer class="game-footer">
            <div class="footer-content" id="event-log">Construction de la Caserne termin√©e.</div>
        </footer>
    </div>
    
    <!-- MODAL DE CONFIRMATION -->
    <div class="modal-overlay" id="upgradeModal">
        <div class="modal-content">
            <h4 id="modalTitle"></h4><p id="modalMessage"></p><div id="modal-cost"></div>
            <div class="modal-actions">
                <button class="modal-btn cancel" id="modalCancelBtn">Annuler</button>
                <button class="modal-btn confirm" id="modalConfirmBtn">Confirmer</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- CONFIGURATION DU JEU ---
            const buildingSpecs = {
                "H√¥tel de Ville": { description: "Augmente la population maximale et le revenu en or.", icon: "üèõÔ∏è", levels: [ { cost: { wood: 150, gold: 0 }, buildTime: 10 }, { cost: { wood: 350, gold: 0 }, buildTime: 25 }, { cost: { wood: 700, gold: 0 }, buildTime: 60 } ] },
                "Caserne": { description: "Permet de recruter des unit√©s terrestres.", icon: "‚öîÔ∏è", levels: [ { cost: { wood: 200, gold: 50 }, buildTime: 15 }, { cost: { wood: 450, gold: 120 }, buildTime: 35 } ] },
                "Entrep√¥t": { description: "Augmente la capacit√© de stockage des ressources.", icon: "üß±", levels: [ { cost: { wood: 250, gold: 0 }, buildTime: 12 }, { cost: { wood: 500, gold: 0 }, buildTime: 30 } ] }
            };
            const cityLayout = [
                { id: "townHall", top: "40%", left: "45%", width: "120px", height: "120px" },
                { id: "plot1", top: "35%", left: "25%", width: "90px", height: "90px" },
                { id: "plot2", top: "55%", left: "30%", width: "90px", height: "90px" },
                { id: "plot3", top: "50%", left: "60%", width: "90px", height: "90px" },
            ];

            // --- √âTAT DU JEU ---
            let gameState = {
                resources: { wood: 1000, wine: 100, marble: 100, crystal: 100, sulfur: 100, gold: 5000 },
                buildings: { "townHall": { type: "H√¥tel de Ville", level: 1 }, "plot1": { type: "Caserne", level: 1 }, "plot2": { type: null, level: 0 }, "plot3": { type: null, level: 0 } },
                buildQueue: []
            };

            // --- √âL√âMENTS DU DOM ---
            const dom = {
                res: { wood: document.getElementById('resWood'), wine: document.getElementById('resWine'), marble: document.getElementById('resMarble'), crystal: document.getElementById('resCrystal'), sulfur: document.getElementById('resSulfur'), gold: document.getElementById('resGold') },
                cityGrid: document.getElementById('city-grid'),
                contextContent: document.getElementById('context-content'),
                buildQueueList: document.getElementById('buildQueueList'),
                eventLog: document.getElementById('event-log'),
                modal: document.getElementById('upgradeModal'),
                modalTitle: document.getElementById('modalTitle'),
                modalMessage: document.getElementById('modalMessage'),
                modalCost: document.getElementById('modal-cost'),
                modalConfirmBtn: document.getElementById('modalConfirmBtn'),
                modalCancelBtn: document.getElementById('modalCancelBtn'),
                navLinks: document.querySelectorAll('.main-nav a'),
                mainViews: document.querySelectorAll('.main-view')
            };

            let selectedPlotId = null;
            let upgradeAction = null;

            // --- NAVIGATION & VUES ---
            function switchView(viewId) {
                dom.mainViews.forEach(view => view.classList.add('hidden'));
                document.getElementById(`view-${viewId}`).classList.remove('hidden');
                
                dom.navLinks.forEach(link => {
                    link.classList.toggle('active', link.dataset.view === viewId);
                });
                updateContextPanel(); // Reset context panel on view switch
            }

            // --- FONCTIONS PRINCIPALES ---
            function init() {
                renderCityLayout();
                updateAllUI();
                switchView('city'); // Vue initiale
                setInterval(gameLoop, 1000);

                // Ajout des √©couteurs pour la navigation
                dom.navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        switchView(link.dataset.view);
                    });
                });
            }

            function gameLoop() {
                processBuildQueue();
                updateBuildQueueUI();
            }

            function processBuildQueue() {
                const now = Date.now();
                const finished = [];
                gameState.buildQueue.forEach((item, index) => {
                    if (now >= item.endTime) {
                        if (item.level === 1) gameState.buildings[item.plotId].type = item.type;
                        gameState.buildings[item.plotId].level = item.level;
                        finished.push(index);
                        document.querySelector(`[data-plot-id='${item.plotId}']`).classList.remove('constructing');
                        logEvent(`${item.type} (Niv. ${item.level}) termin√©.`);
                    }
                });

                if (finished.length > 0) {
                    gameState.buildQueue = gameState.buildQueue.filter((_, index) => !finished.includes(index));
                    renderCityLayout();
                    if (selectedPlotId && finished.some(i => gameState.buildQueue[i]?.plotId === selectedPlotId)) {
                        selectPlot(selectedPlotId);
                    }
                }
            }
            
            function selectPlot(plotId) {
                document.querySelectorAll('.building-plot.selected').forEach(p => p.classList.remove('selected'));
                document.querySelector(`[data-plot-id='${plotId}']`).classList.add('selected');
                selectedPlotId = plotId;
                updateContextPanel(plotId);
            }

            function startUpgrade(plotId, type, targetLevel) {
                const spec = buildingSpecs[type].levels[targetLevel - 1];
                if (gameState.resources.wood < spec.cost.wood || gameState.resources.gold < spec.cost.gold) {
                    alert("Ressources insuffisantes !");
                    return;
                }
                gameState.resources.wood -= spec.cost.wood;
                gameState.resources.gold -= spec.cost.gold;
                const endTime = Date.now() + spec.buildTime * 1000;
                gameState.buildQueue.push({ plotId, type, level: targetLevel, endTime });
                document.querySelector(`[data-plot-id='${plotId}']`).classList.add('constructing');
                logEvent(`Lancement de la construction de ${type} (Niv. ${targetLevel}).`);
                updateAllUI();
                updateContextPanel(plotId);
            }

            // --- FONCTIONS D'AFFICHAGE (UI) ---
            function updateAllUI() {
                updateResourceUI();
                updateBuildQueueUI();
            }

            function updateResourceUI() {
                for (const res in dom.res) {
                    dom.res[res].textContent = Math.floor(gameState.resources[res]);
                }
            }

            function renderCityLayout() {
                dom.cityGrid.innerHTML = '';
                cityLayout.forEach(plot => {
                    const el = document.createElement('div');
                    el.className = 'building-plot';
                    el.dataset.plotId = plot.id;
                    el.style.cssText = `top:${plot.top}; left:${plot.left}; width:${plot.width}; height:${plot.height};`;
                    const buildingState = gameState.buildings[plot.id];
                    if (buildingState && buildingState.type) {
                        el.innerHTML = `${buildingSpecs[buildingState.type].icon}<div class="level">Niv. ${buildingState.level}</div>`;
                    } else {
                        el.innerHTML = '‚ûï';
                    }
                    if (gameState.buildQueue.some(item => item.plotId === plot.id)) {
                        el.classList.add('constructing');
                    }
                    el.addEventListener('click', () => selectPlot(plot.id));
                    dom.cityGrid.appendChild(el);
                });
            }

            function updateContextPanel(plotId) {
                if (!plotId) {
                    dom.contextContent.innerHTML = '<p>S√©lectionnez un √©l√©ment pour voir ses d√©tails.</p>';
                    return;
                }
                const buildingState = gameState.buildings[plotId];
                let html = '';
                if (buildingState && buildingState.type) {
                    const { type, level } = buildingState;
                    const spec = buildingSpecs[type];
                    const nextLevel = level < spec.levels.length ? level + 1 : null;
                    html = `<h3>${type} (Niveau ${level})</h3><p>${spec.description}</p>`;
                    if (gameState.buildQueue.some(item => item.plotId === plotId)) {
                        html += `<p style="color: var(--color-primary); margin-top: 1rem;">Am√©lioration en cours...</p>`;
                    } else if (nextLevel) {
                        html += `<button class="action-btn" data-action="upgrade" data-plot-id="${plotId}" data-type="${type}" data-level="${nextLevel}">Am√©liorer</button>`;
                    } else {
                        html += `<p style="color: var(--color-primary); margin-top: 1rem;">Niveau maximum atteint</p>`;
                    }
                } else {
                    html = `<h3>Emplacement Vide</h3><p>Cliquez sur un b√¢timent ci-dessous pour construire.</p><div class="build-options">`;
                    for (const type in buildingSpecs) {
                        html += `<button class="action-btn" data-action="build" data-plot-id="${plotId}" data-type="${type}" data-level="1">${buildingSpecs[type].icon} ${type}</button>`;
                    }
                    html += `</div>`;
                }
                dom.contextContent.innerHTML = html;
            }
            
            function updateBuildQueueUI() {
                dom.buildQueueList.innerHTML = '';
                gameState.buildQueue.forEach(item => {
                    const remainingTime = Math.max(0, Math.ceil((item.endTime - Date.now()) / 1000));
                    const li = document.createElement('li');
                    li.className = 'queue-item';
                    li.innerHTML = `<div class="name">${item.type} (Niv. ${item.level})</div><div class="timer">${new Date(remainingTime * 1000).toISOString().substr(14, 5)}</div>`;
                    dom.buildQueueList.appendChild(li);
                });
            }
            
            function showUpgradeModal(plotId, type, level) {
                const spec = buildingSpecs[type].levels[level - 1];
                upgradeAction = () => startUpgrade(plotId, type, level);
                dom.modalTitle.textContent = `${level > 1 ? 'Am√©liorer' : 'Construire'} ${type}`;
                dom.modalMessage.textContent = `Voulez-vous vraiment ${level > 1 ? 'am√©liorer' : 'construire'} ce b√¢timent ?`;
                dom.modalCost.innerHTML = `Co√ªt: üå≤${spec.cost.wood} üí∞${spec.cost.gold} - Temps: ${spec.buildTime}s`;
                dom.modal.style.display = 'flex';
            }

            function logEvent(message) {
                dom.eventLog.textContent = message;
            }

            // --- GESTIONNAIRES D'√âV√âNEMENTS ---
            dom.contextContent.addEventListener('click', e => {
                const target = e.target.closest('button');
                if (!target) return;
                const { action, plotId, type, level } = target.dataset;
                if (action === 'upgrade' || action === 'build') {
                    showUpgradeModal(plotId, type, parseInt(level));
                }
            });
            dom.modalConfirmBtn.addEventListener('click', () => {
                if (upgradeAction) upgradeAction();
                dom.modal.style.display = 'none';
                upgradeAction = null;
            });
            dom.modalCancelBtn.addEventListener('click', () => {
                dom.modal.style.display = 'none';
                upgradeAction = null;
            });

            // --- INITIALISATION ---
            init();
        });
    </script>
</body>
</html>
